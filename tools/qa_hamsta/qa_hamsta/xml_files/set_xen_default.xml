<?xml version="1.0"?>
<job>
  <config>
    <name>DefaultXENGrub</name>
    <debuglevel>4</debuglevel>
    <description>Add XEN kernel for default grub boot</description>
    <mail notify="1"></mail>
    <motd>[Custom job]: </motd>
    <rpm>qa_hamsta qa_tools qa_lib_perl </rpm>
  </config>
  <parts>
    <part name="default" id="1" />
  </parts>
  <roles>
    <role name="default">
      <commands part_id="1">
        <worker>
          <command execution="forked" reboot="1"><![CDATA[
#!/bin/bash
res=$((`grep vmlinuz /boot/grub/menu.lst | grep -n xen | awk -F":" '{print $1}'`-1));
sed -i "s/default ./default $res/" /boot/grub/menu.lst;
reboot;
]]></command>
        </worker>
      </commands>
    </role>
  </roles>
</job>
